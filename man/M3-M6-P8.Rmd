### Additional Data for Dyads Spanning 1 Quarter Tone

For the high-resolution dyads centered on 
M3, M6 and P8, the large-scale behavioral 
results and the MaMi.CoDi theoretical 
predictions both show dissonance troughs 
centered on the JT dyads.\

MaMi.CoDi, though, predicts a local maximum 
consonance at the JT dyad (M3, M6 and P8) in the center of each 
dissonance trough. Secondary 
maximums occur at the Pythagorean third and
grave major sixth. Those secondary peaks
are also surrounded by dissonance troughs.
Those secondary dissonance troughs pull 
the curve down forming the shapes we see for both 
the theoretical predictions and the behavioral results
for M3 and M6.\

Do consonance peaks actually exist in the
center of those dissonance troughs
as MaMi.CoDi predicts? Why are those peaks missing
from the behavioral results? Are there examples at other
resolutions of a consonance peak in the center of a dissonance trough?\

Performers of instruments with quantized semitones, 
like keyboards and fretted strings--especially beginners
and their audiences--are aware that highly dissonant 
intervals (M7 and m2) surround the globally maximum
consonant tonic peak at the unison interval (P1).
Dissonance decreases with each semitone step away from the tonic until 
we reach the perfect fifth below (P5) and the perfect fourth above (P4).\

That is to say, at the resolution of 11 semitones,
the tonic pitch is a consonance peak 
in the center of a dissonance trough.\

The MaMi.CoDi model predicts consonance peaks
in the center of dissonance troughs at both
of those scales of resolution.\

#### M3 Major Third

Plot of M3 with MaMi.CoDi tolerance values varying from 1e-08 to 0.1:
![M3 with a range of MaMi.CoDi tolerance values.](./man/tolerance_search_plots/M3 Orders of Magnitude.png)

* JT: 5/4
* ET: 2^(4/12)

```{r, echo=F}
tonic_midi = 60
tibble::tibble(
  just_M3_freq = hrep::midi_to_freq(60) * 5 / 4,
  just_M3_midi = hrep::freq_to_midi(just_M3_freq),
  M3_freq      = hrep::midi_to_freq(64),
  M3_midi      = hrep::freq_to_midi(M3_freq),
)
```

##### Intervals near the major third ranked by consonance

```{r, echo=F}
mami.codi.data <- mami.codi.map('M3', c(0.0002), tonic_midi) %>% dplyr::rowwise() %>% dplyr::mutate(
  semitone       = metadata$semitone + tonic_midi,
  .before=1
) %>% dplyr::ungroup() %>% dplyr::arrange(dplyr::desc(consonance_dissonance))
mami.codi.data %>% dplyr::select('semitone', 'consonance_dissonance')
```

###### The JT M3 has the highest consonance

```{r, echo=F}
just_M3 = mami.codi.data %>% dplyr::slice(1)
```

```{r, echo=F}
just_M3$semitone
```

```{r, echo=F}
just_M3 %>% dplyr::select('semitone', 'consonance_dissonance')
```

###### Frequency ratios of the JT M3

```{r, echo=F}
just_M3$ratios_frequency[[1]]
```

##### Intervals near the major third ranked by lowest consonance

```{r, echo=F}
mami.codi.data %>% dplyr::arrange(consonance_dissonance) %>% 
  dplyr::select('semitone', 'consonance_dissonance')
```

###### The lowest consonance
```{r, echo=F}
dissonant_M3 = mami.codi.data %>% dplyr::arrange(consonance_dissonance) %>% dplyr::slice(1)
```

```{r, echo=F}
dissonant_M3$semitone
```

```{r, echo=F}
dissonant_M3 %>% dplyr::select('semitone', 'consonance_dissonance')
```

###### The lowest consonance ratios

```{r, echo=F}
dissonant_M3$ratios_frequency[[1]]
```

###### The Pythagorean third is the second highest consonance

```{r, echo=F}
P_M3 = mami.codi.data %>% dplyr::slice(2)
```

MIDI:
```{r, echo=F}
P_M3$semitone
```

Cents:
```{r, echo=F}
1200*log(hrep::midi_to_freq(P_M3$semitone)/hrep::midi_to_freq(60))/log(2)
```

Consonance:

```{r, echo=F}
P_M3 %>% dplyr::select('semitone', 'consonance_dissonance')
```

###### Frequency ratios of the second highest consonance

```{r, echo=F}
P_M3$ratios_frequency[[1]]
```

###### References for the Pythagorean third

* "19/15 409.2443014 (good approximation of Pythagorean 3rd)"
     * from [M3 in the Encyclopedia of Microtonal Music Theory](http://www.tonalsoft.com/enc/m/major-3rd.aspx)
* [Pythagorean ditone](https://en.wikipedia.org/wiki/Ditone)


#### M6 Major Sixth

Plot of M6 with MaMi.CoDi tolerance values varying from 1e-08 to 0.1:
![M6 with a range of MaMi.CoDi tolerance values.](./man/tolerance_search_plots/M6 Orders of Magnitude.png)

* JT: 5/3
* ET: 2^(9/12)

```{r, echo=F}
tibble::tibble(
  just_M6_freq = hrep::midi_to_freq(60) * 5 / 3,
  just_M6_midi = hrep::freq_to_midi(just_M6_freq),
  M6_freq      = hrep::midi_to_freq(69),
  M6_midi      = hrep::freq_to_midi(M6_freq),
)
```

##### Intervals near the major sixth ranked by consonance

```{r, echo=F}
mami.codi.data <- mami.codi.map('M6', c(0.0002), tonic_midi) %>% dplyr::rowwise() %>% dplyr::mutate(
  semitone       = metadata$semitone + tonic_midi,
  .before=1
) %>% dplyr::ungroup() %>% dplyr::arrange(dplyr::desc(consonance_dissonance))
mami.codi.data %>% dplyr::select('semitone', 'consonance_dissonance')
```

###### The JT M6 has the highest consonance

```{r, echo=F}
just_M6 = mami.codi.data %>% dplyr::slice(1)
```

```{r, echo=F}
just_M6$semitone
```

```{r, echo=F}
just_M6 %>% dplyr::select('semitone', 'consonance_dissonance')
```

###### Frequency ratios of the JT M6

```{r, echo=F}
just_M6$ratios_frequency[[1]]
```

##### Intervals near the major sixth ranked by lowest consonance

```{r, echo=F}
mami.codi.data %>% dplyr::arrange(consonance_dissonance) %>% 
  dplyr::select('semitone', 'consonance_dissonance')
```

###### The lowest consonance
```{r, echo=F}
dissonant_M6 = mami.codi.data %>% dplyr::arrange(consonance_dissonance) %>% dplyr::slice(1)
```

```{r, echo=F}
dissonant_M6$semitone
```

```{r, echo=F}
dissonant_M6 %>% dplyr::select('semitone', 'consonance_dissonance')
```

###### The lowest consonance ratios

```{r, echo=F}
dissonant_M6$ratios_frequency[[1]]
```

###### The grave major sixth is the second highest consonance

```{r, echo=F}
G_M6 = mami.codi.data %>% dplyr::slice(2)
```

MIDI:
```{r, echo=F}
G_M6$semitone
```

Cents:
```{r, echo=F}
1200*log(hrep::midi_to_freq(G_M6$semitone)/hrep::midi_to_freq(60))/log(2)
```

Consonance:

```{r, echo=F}
G_M6 %>% dplyr::select('semitone', 'consonance_dissonance')
```

###### Frequency ratios of the second highest consonance

```{r, echo=F}
G_M6$ratios_frequency[[1]]
```

###### References for the grave major sixth

* [List of Pitch Intervals](https://en.wikipedia.org/wiki/List_of_pitch_intervals)
* [Grave major sixth on C](https://en.m.wikipedia.org/wiki/File:Grave_major_sixth_on_C.png)

#### P8 Octave

Plot of P8 with MaMi.CoDi tolerance values varying from 1e-08 to 0.1:
![P8 with a range of MaMi.CoDi tolerance values.](./man/tolerance_search_plots/P8 Orders of Magnitude.png)
