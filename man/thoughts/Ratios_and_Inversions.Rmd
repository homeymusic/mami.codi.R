---
title: "Period and Wavelength Relative Periodicity"
output:
  github_document: default
---

# Chord Cycle Estimates

```{r, echo=F, message=F, warning=F}
devtools::load_all('.')
setwd('.')
source('./man/code/plot.R')
source('./man/code/utils.R')
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

```{r, echo=F, results='asis'}
midi  = c(0,4, 7) + 60
tolerance = 0.1
chord = midi %>% mami.codi(
  period_tolerance     = tolerance,
  wavelength_tolerance = tolerance,
  verbose=T,
  num_harmonics=10
)
midi
```

## Spatial

```{r, echo=F, results='asis', message=F}
knitr::kable(tibble::tibble(
  tol_l   = chord$wavelength_tolerance,
  min_l   = min(chord$wavelengths[[1]]),
  lcd_l   = chord$wavelength_lcd,
  chord_l = min_l * lcd_l,
  chord_T = chord_l / SPEED_OF_SOUND * max(chord$wavelengths[[1]])/min_l
))
```

```{r, echo=F, results='asis', message=F}
ratios = chord$wavelength_ratios[[1]] %>%
  dplyr::select(index, num, den, tone)
lcd    = chord$wavelength_lcd
plot_periodicity(ratios, lcd, 'space', log2_scale = T)
```

### Wavelength Ratios

```{r, echo=F, results='asis', message=F}
knitr::kable(chord$wavelength_ratios[[1]] %>% dplyr::arrange(ratio) %>% dplyr::select(-pseudo_ratio))
```

## Temporal
```{r, echo=F, results='asis', message=F}
knitr::kable(tibble::tibble(
  tol_T   = chord$period_tolerance,
  min_T   = min(chord$periods[[1]]),
  lcd_T   = chord$period_lcd,
  chord_T = lcd_T * min_T
))
```

```{r, echo=F, results='asis', message=F}
ratios = chord$period_ratios[[1]] %>% 
  dplyr::select(index, num, den, tone)
lcd    = chord$period_lcd
plot_periodicity(ratios, lcd, 'time', log2_scale = T)
```

### Frequency Ratios
```{r, echo=F, results='asis', message=F}
knitr::kable(chord$period_ratios[[1]] %>% dplyr::arrange(ratio) %>% dplyr::select(-pseudo_ratio))
```

## References
[Periodic function from Wikipedia](https://en.wikipedia.org/wiki/Periodic_Tunction)
